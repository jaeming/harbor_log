# Migration `20200705230256-replace-roles-with-enum`

This migration has been generated by Benji at 7/5/2020, 11:02:57 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TYPE "Permission" AS ENUM ('userRead', 'commentRead', 'commentWrite', 'postWrite', 'postPublish');

ALTER TABLE "public"."User" ADD COLUMN "roles" "Permission"[]  ;

ALTER TABLE "public"."Roles" DROP CONSTRAINT IF EXiSTS "Roles_userId_fkey";

DROP TABLE "public"."Roles";
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200704233036-create-users--roles--posts--comments..20200705230256-replace-roles-with-enum
--- datamodel.dml
+++ datamodel.dml
@@ -3,11 +3,19 @@
 }
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url      = env("DATABASE_URL")
 }
+enum Permission {
+  userRead
+  commentRead
+  commentWrite
+  postWrite
+  postPublish
+}
+
 model Post {
   authorId  Int
   content   String?
   createdAt DateTime @default(now())
@@ -23,21 +31,14 @@
   userId Int     @unique
   user   User    @relation(fields: [userId], references: [id])
 }
-model Roles {
-  id     Int    @default(autoincrement()) @id
-  name   String
-  userId Int
-  user   User   @relation(fields: [userId], references: [id])
-}
-
 model User {
-  admin    Boolean? @default(false)
-  email    String   @unique
-  id       Int      @default(autoincrement()) @id
+  admin    Boolean?     @default(false)
+  email    String       @unique
+  id       Int          @default(autoincrement()) @id
   name     String?
   password String?
   posts    Post[]
   profile  Profile?
-  roles    Roles[]
+  roles    Permission[]
 }
```


